import{_ as H,o,a as f,b as T,g9 as B,d as N,u as ce,c as v,a3 as S,a4 as ue,aE as I,U as y,f as E,w as L,C as i,B as C,t as z,a8 as de,E as W,bc as fe,a1 as F,bd as ge,aD as me,at as pe,a2 as _e,an as ve,ga as be,x as he,as as ye,gb as ke,au as we,e as xe,a7 as Ae,aY as Le}from"./index-60943df8.js";import{_ as Ce}from"./BalTooltip.vue_vue_type_style_index_0_lang-8cf64573.js";import{_ as Te}from"./BalAlert-7103ffb1.js";import{a as A}from"./anime.es-37453147.js";const $e={},Be={width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},We=T("circle",{cx:"9",cy:"9",r:"8",stroke:"currentColor","stroke-opacity":"0.5","stroke-width":"1.5"},null,-1),Ee=T("path",{d:"M9 17C4.58172 17 1 13.4183 1 9",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"bevel","stroke-dasharray":"387 10"},null,-1),Ve=[We,Ee];function Oe(e,s){return o(),f("svg",Be,Ve)}const je=H($e,[["render",Oe]]),ee="/assets/default-69bb0389.svg",Me="/assets/frame-79632d12.svg",Pe="/assets/imtoken-2a9464be.svg",De="/assets/metamask-23fc6a3d.svg",Ie="/assets/status-56c91b2f.svg",te="/assets/tally-4190365d.svg",ze="/assets/trustwallet-f914edfa.svg",Fe="/assets/walletconnect-feb4088f.svg",ne="/assets/walletlink-6b90c776.svg";function He(e,s){return s?e===B.InjectedMetaMask?s.isTally?te:s.isCoinbaseWallet?ne:s.isImToken?Pe:s.isStatus?Ie:s.isTrust?ze:s.isFrame?Me:De:e===B.InjectedTally?te:e===B.WalletConnect?Fe:e===B.WalletLink?ne:ee:ee}var r=(e=>(e[e.Todo=0]="Todo",e[e.Active=1]="Active",e[e.WalletOpen=2]="WalletOpen",e[e.Pending=3]="Pending",e[e.Success=4]="Success",e[e.Warning=5]="Warning",e[e.Error=6]="Error",e[e.Completed=7]="Completed",e))(r||{});const Ne={class:"flex items-center"},Ye=["src"],Re={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},Ue={key:3},qe=N({__name:"BalHorizSteps",props:{steps:{default:()=>[{tooltip:"You did this",state:r.Success},{tooltip:"Wallet is tiggered",state:r.WalletOpen},{tooltip:"This is pending",state:r.Pending},{tooltip:"Do this now",state:r.Active},{tooltip:"Do this next",state:r.Todo}]},spacerWidth:{default:16}},setup(e){const s=r,{connector:a,provider:b}=ce(),k=v(()=>{var c;return He((c=a==null?void 0:a.value)==null?void 0:c.id,b)});function l(c){switch(c){case r.Success:return"border-green-500 dark:border-green-500 text-green-500";case r.Pending:return"border-none dark:border-none text-orange-500";case r.Active:return"border-purple-500 dark:border-purple-500 text-gradient";case r.WalletOpen:return"border-purple-500 dark:border-purple-500 text-gradient";default:return"dark:border-gray-700"}}return(c,_)=>{const V=de,O=je,j=Ce;return o(),f("div",Ne,[(o(!0),f(S,null,ue(c.steps,(h,g)=>(o(),f("div",{key:g,class:"flex items-center"},[g!==0?(o(),f("div",{key:0,class:I(["h-px bg-gray-100 dark:bg-gray-700",`w-${c.spacerWidth}`])},null,2)):y("",!0),E(j,{text:h.tooltip,width:"44",textAlign:"center"},{activator:L(()=>[T("div",{class:I(["step",l(h.state)])},[h.state===i(s).Success?(o(),C(V,{key:0,name:"check"})):h.state===i(s).WalletOpen?(o(),f("img",{key:1,src:i(k),class:"w-4 h-4"},null,8,Ye)):h.state===i(s).Pending?(o(),f(S,{key:2},[T("span",Re,z(g+1),1),E(O,{class:"w-8 h-8 animate-spin"})],64)):(o(),f("span",Ue,z(g+1),1))],2)]),_:2},1032,["text"])]))),128))])}}});const Ge=H(qe,[["__scopeId","data-v-d15daee0"]]),Je=N({props:{initial:{type:Object,default:()=>({opacity:0})},animate:{type:Object,default:()=>({opacity:1})},exit:{type:Object,default:()=>({opacity:0})},unmountInstantly:{type:Boolean,default:()=>!1},isVisible:{type:Boolean,default:()=>!0}},emits:["on-exit","update-dimensions","on-presence"],setup(e,{emit:s}){const a=W();return fe(()=>{a.value&&A.set(a.value,{...e.initial})}),F(()=>e.isVisible,async()=>{e.isVisible&&(await ge(),a.value&&A.set(a.value,{...e.initial}))}),{animateContainer:a,enter:async(l,c)=>{s("on-presence",{isCompleted:!1}),setTimeout(()=>{A({targets:l,...e.animate,easing:"spring(0.2, 80, 10, 0)",complete:()=>{c(),s("on-presence",{isCompleted:!0})}})},0),setTimeout(()=>{a.value&&s("update-dimensions",{width:a.value.offsetWidth,height:a.value.offsetHeight})},0)},leave:(l,c)=>{e.unmountInstantly&&(c(),s("on-exit",{isCompleted:!0})),A.set(l,{"pointer-events":"none"}),A({targets:l,...e.exit,easing:"spring(0.2, 80, 10, 0)",complete:()=>{c(),s("on-exit",{isCompleted:!0})}})}}}}),Ke={key:0,id:"animateContainer",ref:"animateContainer"};function Qe(e,s,a,b,k,l){return o(),C(pe,{class:"relative",appear:"",css:!1,onEnter:e.enter,onLeave:e.leave},{default:L(()=>[e.isVisible?(o(),f("div",Ke,[me(e.$slots,"default")],512)):y("",!0)]),_:3},8,["onEnter","onLeave"])}const Xe=H(Je,[["render",Qe]]),Ze="/assets/signature-fc5d986c.svg",Se=["src"],et={key:1,class:"w-8"},it=N({__name:"BalActionSteps",props:{actions:{},primaryActionType:{},disabled:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},loadingLabel:{default:""}},emits:["success","failed","setCurrentActionIndex"],setup(e,{emit:s}){const a=e,b=s,k={init:!1,confirming:!1,confirmed:!1,confirmedAt:""},l=W(0),c=W(a.actions),_=W([]);_e(()=>{_.value=a.actions.map(()=>({...k}))}),F(()=>a.actions,t=>{t.forEach((n,u)=>{c.value[u]=n,_.value[u]||(_.value[u]={...k})})},{deep:!0}),F(()=>l.value,t=>{b("setCurrentActionIndex",t)},{immediate:!0});const{txListener:V,getTxConfirmedAt:O}=ve(),{formatErrorMsg:j}=be(),{t:h}=he(),g=v(()=>c.value.map((t,n)=>{const u=_.value[n];return{label:t.label,loadingLabel:u.init?t.loadingLabel:t.confirmingLabel,pending:u.init||u.confirming,isSignAction:t.isSignAction,promise:oe.bind(null,t,u),step:{tooltip:t.stepTooltip,state:ie(u,n)}}})),m=v(()=>g.value[l.value]),M=v(()=>_.value[l.value]),Y=v(()=>_.value[_.value.length-1]),R=v(()=>g.value.map(t=>t.step)),se=v(()=>13-R.value.length),ae=v(()=>{var t;return(t=m.value)!=null&&t.pending?m.value.loadingLabel:a.loadingLabel||h("loading")});function ie(t,n){return l.value<n?r.Todo:t.confirming?r.Pending:t.init?r.WalletOpen:t.confirmed?r.Success:r.Active}async function oe(t,n){var p;const{action:u}=t;try{n.init=!0,n.error=null;const d=await u();if(n.init=!1,n.confirming=!0,(p=m.value)!=null&&p.isSignAction){re(n);return}d&&le(d,n,t)}catch(d){n.init=!1,n.confirming=!1,n.error=j(d),ye({error:(d==null?void 0:d.cause)||d,action:a.primaryActionType,context:{level:"fatal"}})}}function re(t){l.value+=1,t.confirming=!1,t.confirmed=!0}async function le(t,n,u){const{postActionValidation:p,actionInvalidReason:d}=u;await V(t,{onTxConfirmed:async w=>{if(n.receipt=w,await ke(t),await(p==null?void 0:p())||!p){const $=await O(w);n.confirmedAt=we($),n.confirmed=!0,l.value>=g.value.length-1?b("success",w,n.confirmedAt):l.value+=1}else d&&(n.error=d),n.init=!1;n.confirming=!1},onTxFailed:()=>{n.confirming=!1,b("failed")}})}return(t,n)=>{const u=Te,p=Ge,d=Ae,w=Le;return o(),f("div",null,[E(Xe,{isVisible:""},{default:L(()=>{var P,$,U,q,G;return[(P=i(M))!=null&&P.error&&!t.isLoading?(o(),C(u,{key:0,type:"error",title:(U=($=i(M))==null?void 0:$.error)==null?void 0:U.title,description:(G=(q=i(M))==null?void 0:q.error)==null?void 0:G.description,block:"",class:"mb-4"},null,8,["title","description"])):y("",!0),E(w,{vertical:""},{default:L(()=>{var J,K,Q;return[i(g).length>1&&!((J=i(Y))!=null&&J.confirmed)?(o(),C(p,{key:0,steps:i(R),spacerWidth:i(se),class:"flex justify-center"},null,8,["steps","spacerWidth"])):y("",!0),(K=i(Y))!=null&&K.confirmed?y("",!0):(o(),C(d,{key:1,disabled:a.disabled,color:"gradient",loading:((Q=i(m))==null?void 0:Q.pending)||t.isLoading,loadingLabel:i(ae),block:"",onClick:n[0]||(n[0]=D=>{var x;return(x=i(m))==null?void 0:x.promise()})},{default:L(()=>{var D,x,X,Z;return[T("div",{class:I({"flex grow justify-between items-center":(D=i(m))==null?void 0:D.isSignAction})},[(x=i(m))!=null&&x.isSignAction?(o(),f("img",{key:0,src:i(Ze)},null,8,Se)):y("",!0),xe(" "+z((X=i(m))==null?void 0:X.label)+" ",1),(Z=i(m))!=null&&Z.isSignAction?(o(),f("div",et)):y("",!0)],2)]}),_:1},8,["disabled","loading","loadingLabel"]))]}),_:1})]}),_:1})])}}});export{Xe as A,r as S,it as _};
//# sourceMappingURL=BalActionSteps.vue_vue_type_script_setup_true_lang-cd43f961.js.map
