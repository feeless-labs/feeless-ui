{"version":3,"file":"CheckpointGaugeModal.vue_vue_type_script_setup_true_lang-2cec8479.js","sources":["../../src/components/contextual/pages/vebal/cross-chain-boost/CheckpointGaugeModal.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport useTransactions from '@/composables/useTransactions';\nimport useWeb3 from '@/services/web3/useWeb3';\nimport { useUserStaking } from '@/providers/local/user-staking.provider';\nimport useEthers from '@/composables/useEthers';\n\ninterface Props {\n  isVisible: boolean;\n  poolAddress: string;\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  isVisible: false,\n});\n\nconst emit = defineEmits(['close', 'success']);\n\nconst { checkpointGauge, userGaugeShares } = useUserStaking();\nconst { addTransaction } = useTransactions();\nconst { isMismatchedNetwork } = useWeb3();\nconst { txListener } = useEthers();\n\nconst showCloseBtn = ref(false);\n\nasync function triggerUpdate() {\n  try {\n    const gauge = userGaugeShares.value?.find(\n      gauge => gauge.gauge.poolAddress === props.poolAddress\n    );\n    const id = gauge?.gauge.id;\n\n    if (!id) {\n      throw new Error('No gauge id');\n    }\n\n    const tx = await checkpointGauge(id);\n\n    addTransaction({\n      id: tx.hash,\n      type: 'tx',\n      action: 'userGaugeCheckpoint',\n      summary: '',\n    });\n\n    await txListener(tx, {\n      onTxConfirmed: async () => {\n        emit('success', props.poolAddress);\n      },\n      onTxFailed: () => {\n        console.error('Tx failed');\n      },\n    });\n\n    return tx;\n  } catch (e) {\n    console.error(e);\n    return Promise.reject(e);\n  }\n}\n\nconst actions = [\n  {\n    label: 'Confirm pool gauge update',\n    loadingLabel: 'Confirming pool gauge update',\n    confirmingLabel: 'Confirming pool gauge update',\n    action: async () => {\n      return triggerUpdate();\n    },\n    stepTooltip: '',\n  },\n];\n</script>\n\n<template>\n  <BalModal\n    :show=\"isVisible\"\n    :disabled=\"isMismatchedNetwork\"\n    title=\"Trigger pool gauge veBAL update\"\n    @close=\"emit('close')\"\n  >\n    <div class=\"flex flex-col justify-between\">\n      <span class=\"mb-12\">\n        Even though you've synced new veBAL to this Layer 2, it isnâ€™t\n        contributing to your staking boost yet on this pool. This is because,\n        pool gauges don't detect veBAL changes until you interact with them.\n        This transaction is the most gas efficient way to update the gauge but\n        you can also trigger the update by claiming any BAL incentives.\n      </span>\n\n      <BalActionSteps\n        :actions=\"actions\"\n        primaryActionType=\"userGaugeCheckpoint\"\n        @success=\"showCloseBtn = true\"\n      />\n\n      <BalBtn\n        v-if=\"showCloseBtn\"\n        color=\"gray\"\n        outline\n        block\n        @click=\"$emit('close')\"\n      >\n        {{ $t('close') }}\n      </BalBtn>\n    </div>\n  </BalModal>\n</template>\n"],"names":["props","__props","emit","__emit","checkpointGauge","userGaugeShares","useUserStaking","addTransaction","useTransactions","isMismatchedNetwork","useWeb3","txListener","useEthers","showCloseBtn","ref","triggerUpdate","gauge","_a","gauge2","id","tx","actions"],"mappings":"60BAWA,MAAAA,EAAAC,EAIAC,EAAAC,EAEA,CAAA,gBAAAC,EAAA,gBAAAC,CAAA,EAAAC,EAAA,EACA,CAAA,eAAAC,GAAAC,IACA,CAAA,oBAAAC,GAAAC,IACA,CAAA,WAAAC,GAAAC,IAEAC,EAAAC,EAAA,EAAA,EAEA,eAAAC,GAAA,OACE,GAAA,CACE,MAAAC,GAAAC,EAAAZ,EAAA,QAAA,YAAAY,EAAA,KAAqCC,GAAAA,EAAA,MAAA,cAAAlB,EAAA,aAGrCmB,EAAAH,GAAA,YAAAA,EAAA,MAAA,GAEA,GAAA,CAAAG,EACE,MAAA,IAAA,MAAA,aAAA,EAGF,MAAAC,EAAA,MAAAhB,EAAAe,CAAA,EAEA,OAAAZ,EAAA,CAAe,GAAAa,EAAA,KACN,KAAA,KACD,OAAA,sBACE,QAAA,EACC,CAAA,EAGX,MAAAT,EAAAS,EAAA,CAAqB,cAAA,SAAA,CAEjBlB,EAAA,UAAAF,EAAA,WAAA,CAAiC,EACnC,WAAA,IAAA,CAEE,QAAA,MAAA,WAAA,CAAyB,CAC3B,CAAA,EAGFoB,CAAO,OAAA,EAAA,CAEP,eAAA,MAAA,CAAA,EACA,QAAA,OAAA,CAAA,CAAuB,CACzB,CAGF,MAAAC,EAAA,CAAgB,CACd,MAAA,4BACS,aAAA,+BACO,gBAAA,+BACG,OAAA,SAEfN,EAAA,EACF,YAAA,EACa,CACf"}