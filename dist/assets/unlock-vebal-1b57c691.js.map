{"version":3,"file":"unlock-vebal-1b57c691.js","sources":["../../src/components/forms/lock_actions/UnlockForm/components/VeBalUnlockForm/components/LockedAmount.vue","../../src/components/forms/lock_actions/UnlockForm/components/VeBalUnlockForm/VeBalUnlockForm.vue","../../src/components/forms/lock_actions/UnlockForm/UnlockForm.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport useNumbers, { FNumFormats } from '@/composables/useNumbers';\nimport { Pool } from '@/services/pool/types';\nimport { TokenInfo } from '@/types/TokenList';\n\n/**\n * TYPES\n */\ntype Props = {\n  lockablePool: Pool;\n  lockablePoolTokenInfo: TokenInfo;\n  totalLpTokens: string;\n  fiatTotalLpTokens: string;\n};\n\n/**\n * PROPS\n */\ndefineProps<Props>();\n\n/**\n * COMPOSABLES\n */\nconst { fNum } = useNumbers();\n</script>\n\n<template>\n  <div class=\"mb-6\">\n    <div class=\"pb-4\">\n      {{ $t('unlockVeBAL.unlockForm.lockedAmount.title') }}\n    </div>\n    <div class=\"p-3 dark:bg-gray-800 rounded-lg border dark:border-gray-800\">\n      <div class=\"flex items-center\">\n        <BalAsset :address=\"lockablePool.address\" class=\"mr-2\" :size=\"36\" />\n        <div class=\"w-full\">\n          <div class=\"flex justify-between\">\n            <div>{{ lockablePoolTokenInfo.symbol }}</div>\n            <div>{{ fNum(totalLpTokens, FNumFormats.token) }}</div>\n          </div>\n          <div class=\"flex justify-between text-gray-500\">\n            <div>{{ lockablePoolTokenInfo.name }}</div>\n            <div>{{ fNum(fiatTotalLpTokens, FNumFormats.fiat) }}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { computed, ref } from 'vue';\n\nimport { bnum } from '@/lib/utils';\nimport { VeBalLockInfo } from '@/services/balancer/contracts/contracts/veBAL';\nimport { configService } from '@/services/config/config.service';\nimport { Pool } from '@/services/pool/types';\nimport useWeb3 from '@/services/web3/useWeb3';\nimport { TokenInfo } from '@/types/TokenList';\n\nimport UnlockPreviewModal from '../UnlockPreviewModal/UnlockPreviewModal.vue';\nimport LockedAmount from './components/LockedAmount.vue';\n\n/**\n * TYPES\n */\ntype Props = {\n  lockablePool: Pool;\n  lockablePoolTokenInfo: TokenInfo;\n  veBalLockInfo: VeBalLockInfo;\n};\n\n/**\n * PROPS\n */\nconst props = defineProps<Props>();\n\n/**\n * STATE\n */\nconst showPreviewModal = ref(false);\n\n/**\n * COMPOSABLES\n */\nconst { isWalletReady, startConnectWithInjectedProvider, isMismatchedNetwork } =\n  useWeb3();\n\n/**\n * COMPUTED\n */\nconst totalLpTokens = computed(() =>\n  props.veBalLockInfo?.isExpired ? props.veBalLockInfo.lockedAmount : '0'\n);\n\nconst fiatTotalLpTokens = computed(() =>\n  bnum(props.lockablePool.totalLiquidity)\n    .div(props.lockablePool.totalShares)\n    .times(totalLpTokens.value)\n    .toString()\n);\n\nconst submissionDisabled = computed(() => {\n  if (isMismatchedNetwork.value) {\n    return true;\n  }\n\n  return bnum(totalLpTokens.value).isZero();\n});\n</script>\n\n<template>\n  <BalCard shadow=\"xl\" exposeOverflow noBorder>\n    <template #header>\n      <div class=\"w-full\">\n        <div class=\"text-xs leading-none text-secondary\">\n          {{ configService.network.chainName }}\n        </div>\n        <div class=\"flex justify-between items-center\">\n          <h4>\n            {{ $t('unlockVeBAL.unlockForm.title') }}\n          </h4>\n        </div>\n      </div>\n    </template>\n\n    <LockedAmount\n      :lockablePool=\"lockablePool\"\n      :lockablePoolTokenInfo=\"lockablePoolTokenInfo\"\n      :totalLpTokens=\"totalLpTokens\"\n      :fiatTotalLpTokens=\"fiatTotalLpTokens\"\n    />\n\n    <div class=\"mt-6\">\n      <BalBtn\n        v-if=\"!isWalletReady\"\n        :label=\"$t('connectWallet')\"\n        color=\"gradient\"\n        block\n        @click=\"startConnectWithInjectedProvider\"\n      />\n      <BalBtn\n        v-else\n        color=\"gradient\"\n        block\n        :disabled=\"submissionDisabled\"\n        @click=\"showPreviewModal = true\"\n      >\n        {{ $t('preview') }}\n      </BalBtn>\n    </div>\n  </BalCard>\n  <teleport to=\"#modal\">\n    <UnlockPreviewModal\n      v-if=\"showPreviewModal\"\n      :lockablePool=\"lockablePool\"\n      :lockablePoolTokenInfo=\"lockablePoolTokenInfo\"\n      :veBalLockInfo=\"veBalLockInfo\"\n      :totalLpTokens=\"totalLpTokens\"\n      :fiatTotalLpTokens=\"fiatTotalLpTokens\"\n      @close=\"showPreviewModal = false\"\n    />\n  </teleport>\n</template>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue';\n\nimport Col3Layout from '@/components/layouts/Col3Layout.vue';\nimport usePoolQuery from '@/composables/queries/usePoolQuery';\nimport useVeBalLockInfoQuery from '@/composables/queries/useVeBalLockInfoQuery';\nimport { useTokens } from '@/providers/tokens.provider';\nimport useVeBal from '@/composables/useVeBAL';\nimport { Pool } from '@/services/pool/types';\nimport useWeb3 from '@/services/web3/useWeb3';\n\nimport MyVeBAL from '../LockForm/components/MyVeBAL.vue';\nimport VeBalUnlockForm from './components/VeBalUnlockForm/VeBalUnlockForm.vue';\n\n/**\n * COMPOSABLES\n */\nconst { getToken } = useTokens();\nconst { isWalletReady } = useWeb3();\nconst { lockablePoolId } = useVeBal();\n\n/**\n * QUERIES\n */\nconst lockablePoolQuery = usePoolQuery(lockablePoolId.value as string);\nconst veBalLockInfoQuery = useVeBalLockInfoQuery();\n\n/**\n * COMPUTED\n */\nconst lockablePoolLoading = computed(() => lockablePoolQuery.isLoading.value);\n\nconst veBalQueryLoading = computed(() => veBalLockInfoQuery.isLoading.value);\n\nconst lockablePool = computed<Pool | undefined>(\n  () => lockablePoolQuery.data.value\n);\n\nconst lockablePoolTokenInfo = computed(() =>\n  lockablePool.value != null ? getToken(lockablePool.value.address) : null\n);\n\nconst veBalLockInfo = computed(() => veBalLockInfoQuery.data.value);\n\nconst isLoading = computed(() =>\n  isWalletReady.value\n    ? lockablePoolLoading.value || veBalQueryLoading.value\n    : lockablePoolLoading.value\n);\n</script>\n\n<template>\n  <Col3Layout offsetGutters>\n    <BalLoadingBlock\n      v-if=\"\n        isLoading || !veBalLockInfo || !lockablePool || !lockablePoolTokenInfo\n      \"\n      class=\"h-96\"\n    />\n    <VeBalUnlockForm\n      v-else\n      :key=\"\n        veBalLockInfo?.hasExistingLock\n          ? 'veBalUnlockForm-hasLock'\n          : 'veBalUnlockForm-noLock'\n      \"\n      :lockablePool=\"lockablePool\"\n      :lockablePoolTokenInfo=\"lockablePoolTokenInfo\"\n      :veBalLockInfo=\"veBalLockInfo\"\n    />\n\n    <template #gutterRight>\n      <BalLoadingBlock v-if=\"isLoading\" class=\"h-64\" />\n      <MyVeBAL v-else :veBalLockInfo=\"veBalLockInfo\" />\n    </template>\n  </Col3Layout>\n</template>\n"],"names":["fNum","useNumbers","props","__props","showPreviewModal","ref","isWalletReady","startConnectWithInjectedProvider","isMismatchedNetwork","useWeb3","totalLpTokens","computed","_a","fiatTotalLpTokens","bnum","submissionDisabled","getToken","useTokens","lockablePoolId","useVeBal","lockablePoolQuery","usePoolQuery","veBalLockInfoQuery","useVeBalLockInfoQuery","lockablePoolLoading","veBalQueryLoading","lockablePool","lockablePoolTokenInfo","veBalLockInfo","isLoading"],"mappings":"woCAuBA,KAAA,CAAA,KAAAA,GAAAC,usBCEA,MAAAC,EAAAC,EAKAC,EAAAC,EAAA,EAAA,EAKA,CAAA,cAAAC,EAAA,iCAAAC,EAAA,oBAAAC,CAAA,EAAAC,EAAA,EAMAC,EAAAC,EAAsB,IAAA,OAAA,OAAAC,EAAAV,EAAA,gBAAA,MAAAU,EAAA,UAAAV,EAAA,cAAA,aAAA,IACgD,EAGtEW,EAAAF,EAA0B,IAAAG,EAAAZ,EAAA,aAAA,cAAA,EAAA,IAAAA,EAAA,aAAA,WAAA,EAAA,MAAAQ,EAAA,KAAA,EAAA,SAAA,CAIZ,EAGdK,EAAAJ,EAAA,IACEH,EAAA,MACE,GAGFM,EAAAJ,EAAA,KAAA,EAAA,OAAA,CAAwC,yoCCxC1C,KAAA,CAAA,SAAAM,GAAAC,IACA,CAAA,cAAAX,GAAAG,IACA,CAAA,eAAAS,GAAAC,IAKAC,EAAAC,EAAAH,EAAA,KAAA,EACAI,EAAAC,IAKAC,EAAAb,EAAA,IAAAS,EAAA,UAAA,KAAA,EAEAK,EAAAd,EAAA,IAAAW,EAAA,UAAA,KAAA,EAEAI,EAAAf,EAAqB,IAAAS,EAAA,KAAA,KACU,EAG/BO,EAAAhB,EAA8B,IAAAe,EAAA,OAAA,KAAAV,EAAAU,EAAA,MAAA,OAAA,EAAA,IACwC,EAGtEE,EAAAjB,EAAA,IAAAW,EAAA,KAAA,KAAA,EAEAO,EAAAlB,EAAkB,IAAAL,EAAA,MAAAkB,EAAA,OAAAC,EAAA,MAAAD,EAAA,KAGQ"}