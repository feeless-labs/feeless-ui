import{u as b,k as _,c as p,gg as x,j as d,cZ as h,N as W,r as T,Q as O,m as B,E as u,an as I,am as N,x as k,bT as P,g9 as j,gh as D,gi as F,gj as Q,c2 as q,a1 as U}from"./index-60943df8.js";import{F as V}from"./vue-query-ecc7fe75.js";import{b as Y}from"./constants-dee7c074.js";function G(e,v={}){const{account:a,isWalletReady:t}=b(),{networkId:o}=_(),n=p(()=>t.value),g=x(),r=p(()=>new g(d.network.addresses.vault,h.Vault__factory.abi,W.jsonProvider)),y=T(O.Account.RelayerApprovals(o,a,e)),f=async()=>e.value?await r.value.hasApprovedRelayer(a.value,e.value):!0,s=T({enabled:n,...V,...v});return B(y,f,s)}const H=d.network.addresses.vault;function K(e,v=u(!0)){const a=u(!1),t=u(!1),o=u(!1),{getSigner:n,account:g}=b(),r=u(L[e]),{txListener:y}=I(),{addTransaction:f}=N(),{t:s}=k(),c=G(r),l=p(()=>o.value||(v.value?!!c.data.value:!0)),m=p(()=>c.isLoading.value||c.isError.value),A=p(()=>({label:s("transactionSummary.approveRelayer",[e]),loadingLabel:s("actionSteps.approve.loadingLabel"),confirmingLabel:s("confirming"),stepTooltip:s("approveRelayerTooltip"),action:R}));async function R(){try{a.value=!0;const C=await new P(n()).contract.sendTransaction({contractAddress:d.network.addresses.vault,abi:h.Vault__factory.abi,action:"setRelayerApproval",params:[g.value,r.value,!0]});return a.value=!1,t.value=!0,w(C),C}catch(i){return console.log(i),a.value=!1,t.value=!1,Promise.reject(i)}}async function w(i){f({id:i.hash,type:"tx",action:"approve",summary:s("transactionSummary.approveRelayer",[e]),details:{contractAddress:H,spender:r.value}}),o.value=await y(i,{onTxConfirmed:async()=>{t.value=!1,c.refetch()},onTxFailed:()=>{t.value=!1}})}return{action:A,init:a,approve:R,approving:t,approved:o,isUnlocked:l,loading:m}}function M(e){return e===j.WalletConnect}let E=F;function Z(){return E||D("Relayer"),E}var z=(e=>(e.COWSWAP="Cowswap",e.LIDO="Lido",e.BATCH="Batch",e))(z||{});const L={Cowswap:Y,Lido:d.network.addresses.lidoRelayer,Batch:d.network.addresses.batchRelayer},S=u("");function ee(e){const{account:v,getSigner:a,connector:t}=b(),{networkId:o}=_(),{t:n}=k(),{isGnosisSafeApp:g}=Q(),r=K(e),{supportSignatures:y}=q(),f={label:n("signRelayerApproval"),loadingLabel:n("checkWallet"),confirmingLabel:n("signingRelayerApproval"),stepTooltip:n("signRelayerApprovalTooltip"),action:c,isSignAction:!0},s=p(()=>{var l;return!y.value||g.value||M((l=t.value)==null?void 0:l.id)?r.action.value:f});async function c(){const l=Z(),m=L[e],A=a(),R=await A.getAddress(),w=await l.signRelayerApproval(m,R,A,h.Vault__factory.connect(d.network.addresses.vault,A));S.value=w}return U([v,o],()=>{S.value=""}),{relayerSignature:S,relayerApprovalAction:s,relayerApprovalTx:r}}export{z as R,ee as a,G as b,K as u};
//# sourceMappingURL=useRelayerApproval-8e49cdc5.js.map
