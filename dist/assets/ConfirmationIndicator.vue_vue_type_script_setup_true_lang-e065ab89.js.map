{"version":3,"file":"ConfirmationIndicator.vue_vue_type_script_setup_true_lang-e065ab89.js","sources":["../../src/components/web3/ConfirmationIndicator.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { TransactionReceipt } from '@ethersproject/abstract-provider';\nimport { computed, reactive } from 'vue';\nimport { useQuery } from '@tanstack/vue-query';\n\nimport useConfig from '@/composables/useConfig';\nimport useEthers from '@/composables/useEthers';\nimport { dateTimeLabelFor } from '@/composables/useTime';\nimport QUERY_KEYS from '@/constants/queryKeys';\nimport useWeb3 from '@/services/web3/useWeb3';\n\ntype Props = {\n  txReceipt: TransactionReceipt;\n};\n\ntype ConfirmationData = {\n  confirmedAt: string;\n  explorerLink: string;\n};\n\nconst props = defineProps<Props>();\n\n/**\n * COMPOSABLES\n */\nconst { getTxConfirmedAt } = useEthers();\nconst { explorerLinks } = useWeb3();\nconst { networkConfig } = useConfig();\n\n/**\n * COMPUTED\n */\nconst isQueryEnabled = computed(() => !!receipt.value?.transactionHash);\n\nconst receipt = computed(() => props.txReceipt);\n\n/**\n * QUERIES\n */\nconst {\n  data: confirmationData,\n  isLoading: isFetchingConfirmationDate,\n  error,\n} = useQuery<ConfirmationData>(\n  QUERY_KEYS.Transaction.ConfirmationDate(receipt),\n  async () => {\n    const confirmedAt = await getTxConfirmedAt(receipt.value);\n    const explorerLink = explorerLinks.txLink(receipt.value.transactionHash);\n    return {\n      confirmedAt: dateTimeLabelFor(confirmedAt),\n      explorerLink,\n    };\n  },\n  reactive({ enabled: isQueryEnabled })\n);\n\nconst isLoading = computed(\n  (): boolean => isFetchingConfirmationDate.value || !!error.value\n);\n</script>\n\n<template>\n  <BalLoadingBlock v-if=\"isLoading\" class=\"h-6\" />\n  <div\n    v-else\n    class=\"flex justify-between items-center text-sm text-gray-400 dark:text-gray-600\"\n  >\n    <div class=\"flex items-center\">\n      <BalIcon name=\"clock\" />\n      <span class=\"ml-2\">\n        {{ confirmationData?.confirmedAt }}\n      </span>\n    </div>\n    <BalLink\n      :href=\"confirmationData?.explorerLink\"\n      external\n      noStyle\n      class=\"group flex items-center\"\n    >\n      {{ networkConfig.explorerName }}\n      <BalIcon\n        name=\"arrow-up-right\"\n        size=\"sm\"\n        class=\"ml-px group-hover:text-pink-500 transition-colors\"\n      />\n    </BalLink>\n  </div>\n</template>\n"],"names":["props","__props","getTxConfirmedAt","useEthers","explorerLinks","useWeb3","networkConfig","useConfig","isQueryEnabled","computed","_a","receipt","confirmationData","isFetchingConfirmationDate","error","useQuery","QUERY_KEYS","confirmedAt","explorerLink","dateTimeLabelFor","reactive","isLoading"],"mappings":"4aAoBA,MAAAA,EAAAC,EAKA,CAAA,iBAAAC,GAAAC,IACA,CAAA,cAAAC,GAAAC,IACA,CAAA,cAAAC,GAAAC,IAKAC,EAAAC,EAAA,IAAA,OAAA,OAAA,GAAAC,EAAAC,EAAA,QAAA,MAAAD,EAAA,iBAAA,EAEAC,EAAAF,EAAA,IAAAT,EAAA,SAAA,EAKA,CAAM,KAAAY,EACE,UAAAC,EACK,MAAAC,CACX,EAAAC,EACEC,EAAA,YAAA,iBAAAL,CAAA,EAC6C,SAAA,CAE7C,MAAAM,EAAA,MAAAf,EAAAS,EAAA,KAAA,EACAO,EAAAd,EAAA,OAAAO,EAAA,MAAA,eAAA,EACA,MAAA,CAAO,YAAAQ,EAAAF,CAAA,EACoC,aAAAC,CACzC,CACF,EACFE,EAAA,CAAA,QAAAZ,EAAA,CACoC,EAGtCa,EAAAZ,EAAkB,IAAAI,EAAA,OAAA,CAAA,CAAAC,EAAA,KAC2C"}