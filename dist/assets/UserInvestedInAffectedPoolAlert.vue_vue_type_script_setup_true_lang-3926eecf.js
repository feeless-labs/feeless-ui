import{d as U,b1 as Ce,aA as Pe,k as ee,c as l,aM as F,b6 as we,o as a,a as m,C as t,B as _,w as v,e as I,t as S,b8 as x,a7 as ue,fQ as Ae,f as G,fv as Q,fR as Be,U as w,fu as Se,fS as Te,b2 as $e,E as Y,fT as Le,b as q,a3 as X,a4 as Ie,aE as de,bt as Ge,b5 as De,fU as Me,y as Ne,D as xe,x as qe,u as ce,G as Z,bj as te,fV as Oe,bk as Re,b7 as Fe,J as K,K as Ue,L as Ve,bl as Ee,bm as oe,fW as We,bg as ze,j as me,bi as je,aq as He,I as Qe,H as Ke,d4 as Je,fX as Ye,fY as ae,S as T,V as ne,n as z,m as ie,z as J,fZ as Xe,aW as Ze,aX as le,a_ as es}from"./index-60943df8.js";import{_ as ss}from"./BalTable.vue_vue_type_style_index_0_lang-bf21b918.js";import{_ as ge}from"./BalTooltip.vue_vue_type_style_index_0_lang-8cf64573.js";import{_ as ts}from"./BalAsset-68194947.js";import{_ as os}from"./BalAssetSet-c1957457.js";import{P as as}from"./constants-5d025550.js";import{_ as ns}from"./APRTooltip.vue_vue_type_script_setup_true_lang-7ca94d25.js";import{u as is}from"./useBreakpoints-76e5f77c.js";import{_ as ls}from"./TokenPills.vue_vue_type_script_setup_true_lang-ee78290c.js";import{T as rs,a as us}from"./tokens_black-ddc115cd.js";import{_ as ds}from"./BalChip-810690c3.js";import{_ as cs}from"./BalChipNew.vue_vue_type_script_setup_true_lang-42797145.js";import{_ as ms}from"./PoolWarningTooltip.vue_vue_type_script_setup_true_lang-d116052e.js";import{_ as re,P as gs}from"./PoolFeatureChip.vue_vue_type_script_setup_true_lang-913aa74f.js";import{u as ps}from"./useDisabledJoinPool-1947dad7.js";import{_ as ks}from"./BalAlert-7103ffb1.js";const fs={class:"flex justify-center py-4 px-2"},ys={key:4},vs=U({__name:"PoolsTableActionsCell",props:{pool:{},poolsType:{default:"unstaked"}},emits:["click:stake","click:unstake","click:migrate"],setup(g,{emit:n}){const r=g,c=n,{isMigratablePool:k}=Ce(Pe(r,"pool")),{networkSlug:f}=ee(),p=l(()=>F.Stakable.VotingGaugePools.concat(F.Stakable.AllowList)),A=l(()=>we(r.pool.id));return(d,b)=>{const C=ue;return a(),m("div",fs,[t(k)(d.pool)?(a(),_(C,{key:0,color:"gradient",size:"sm",onClick:b[0]||(b[0]=x(u=>c("click:migrate",d.pool),["prevent","stop"]))},{default:v(()=>[I(S(d.$t("migrate")),1)]),_:1})):d.poolsType==="unstaked"&&p.value.includes(d.pool.id)?(a(),_(C,{key:1,color:"gradient",size:"sm",disabled:t(k)(d.pool),onClick:b[1]||(b[1]=x(u=>c("click:stake",d.pool),["prevent","stop"]))},{default:v(()=>[I(S(d.$t("stake")),1)]),_:1},8,["disabled"])):d.poolsType==="staked"?(a(),_(C,{key:2,class:"dark:text-gray-300 dark:border-gray-300",outline:"",size:"sm",onClick:b[2]||(b[2]=x(u=>c("click:unstake",d.pool),["prevent","stop"]))},{default:v(()=>[I(S(d.$t("unstake")),1)]),_:1})):A.value?(a(),_(C,{key:3,tag:"router-link",to:{name:"get-vebal",query:{networkSlug:t(f),returnRoute:d.$route.name,returnParams:JSON.stringify({networkSlug:t(f)})}},color:"gradient-pink-yellow",size:"sm"},{default:v(()=>[I(S(d.$t("transactionAction.createLock")),1)]),_:1},8,["to"])):(a(),m("div",ys,"-"))])}}}),hs={class:"flex items-center"},_s=U({__name:"PoolsTableExtraInfo",props:{pool:{}},setup(g){return(n,r)=>{var f;const c=ge,k=ds;return a(),m("div",hs,[t(Ae)(n.pool)?(a(),_(c,{key:0,text:n.$t("boostedTooltip"),width:"56"},{activator:v(()=>[G(re,{feature:t(Q).Boosted,protocols:t(Be)(n.pool,t(Q).Boosted),class:"ml-1"},null,8,["feature","protocols"])]),_:1},8,["text"])):w("",!0),t(Se)(n.pool)?(a(),_(c,{key:1,text:n.$t("clpTooltip"),width:"56"},{activator:v(()=>[G(re,{feature:t(Q).CLP,protocols:[t(gs).Gyro],class:"ml-1"},null,8,["feature","protocols"])]),_:1},8,["text"])):w("",!0),t(Te)(n.pool.poolType)?(a(),_(k,{key:2,label:"LBP",color:"amber",class:"text-xs font-medium"})):(f=n.pool)!=null&&f.isNew?(a(),_(cs,{key:3,class:"text-lg font-medium"})):w("",!0),G(ms,{pool:n.pool},null,8,["pool"])])}}}),bs="/assets/add-95e5000c.svg",Cs="/assets/migrateGauge-f2513340.svg",Ps="/assets/poke-76ed2d85.svg",ws="/assets/remove-7aa97297.svg",As="/assets/stake-19a52128.svg",Bs="/assets/unstake-2d312a6e.svg",Ss="/assets/vote-c987fd96.svg";var $=(g=>(g.Add="add",g.Remove="remove",g.Stake="stake",g.Unstake="unstake",g.Vote="vote",g.MigrateGauge="migrateGauge",g.Poke="poke",g))($||{});const Ts={key:0,class:"absolute w-3 h-3 bg-red-500 rounded-full border-2 border-white right-[-4px] top-[-4px]"},$s={key:0,class:"absolute z-10 bg-white dark:bg-gray-700 rounded border border-gray-200 shadow right-[60px] top-[50px] radius-md"},Ls=["onClick"],Is=["src"],Gs={class:"pr-5 pl-2"},Ds=U({__name:"PoolsTableActionSelector",props:{pool:{},defaultPoolActions:{},showPokeAction:{type:Boolean,default:!1},showMigrateGaugeAction:{type:Boolean,default:!1}},emits:["click:add","click:remove","click:unstake","click:vote","click:poke","click:migrateGauge"],setup(g){const n=g,{isAffectedBy:r}=$e(l(()=>n.pool.id)),{shouldDisableJoins:c}=ps(n.pool),k=Y(!1);function f(){k.value=!1}function p(u){return new URL(Object.assign({"/src/assets/images/icons/pool-actions/add.svg":bs,"/src/assets/images/icons/pool-actions/migrateGauge.svg":Cs,"/src/assets/images/icons/pool-actions/poke.svg":Ps,"/src/assets/images/icons/pool-actions/remove.svg":ws,"/src/assets/images/icons/pool-actions/stake.svg":As,"/src/assets/images/icons/pool-actions/unstake.svg":Bs,"/src/assets/images/icons/pool-actions/vote.svg":Ss})[`/src/assets/images/icons/pool-actions/${u}.svg`],self.location).href}function A(u){var M;const L=!!Ge(n.pool.id)||r(De.PoolProtocolFeeVulnWarning)||Me(n.pool.id)||c.value||((M=F.BrandedRedirect)==null?void 0:M[n.pool.poolType]),y=[$.Add,$.Stake,$.MigrateGauge],D=F.Stakable.VotingGaugePools.includes(n.pool.id)||F.Stakable.AllowList.includes(n.pool.id);return L&&y.includes(u)||!D&&u===$.Stake}const d=l(()=>{const u=[...n.defaultPoolActions];return n.showMigrateGaugeAction?u.unshift($.MigrateGauge):n.showPokeAction&&u.unshift($.Poke),u}),b=l(()=>d.value.some(u=>u==="migrateGauge"||u==="poke")),C=Y(null);return Le(C,f),(u,L)=>t(d)?(a(),m("div",{key:0,ref_key:"clickOutsideTarget",ref:C,class:"flex relative justify-end py-4 pr-8"},[q("div",{class:"flex relative justify-center items-center w-7 h-7 text-blue-600 hover:bg-blue-50 rounded-md border-2 border-blue-600 transition-all duration-200 text-[8px]",onClick:L[0]||(L[0]=x(y=>k.value=!t(k),["stop"]))},[t(b)?(a(),m("div",Ts)):w("",!0),I(" ••• ")]),t(k)?(a(),m("ul",$s,[(a(!0),m(X,null,Ie(t(d),y=>(a(),m(X,{key:y},[A(y)?w("",!0):(a(),m("li",{key:0,class:de(["flex items-center py-3 pr-10 pl-3 font-medium text-left dark:hover:text-gray-600 whitespace-pre hover:bg-gray-100 first:rounded-t cursor-pointer radius-md",{"bg-red-50 hover:bg-red-100 dark:bg-red-300 border-b border-gray-200":y===t($).Poke||y===t($).MigrateGauge}]),onClick:x(D=>u.$emit(`click:${y}`,u.pool),["stop"])},[q("img",{src:p(y),alt:"",class:"p-0.5 rounded-full w-[20px]"},null,8,Is),q("div",Gs,S(u.$t(`poolActions.${y}`)),1)],10,Ls))],64))),128))])):w("",!0)],512)):w("",!0)}}),Ms={class:"flex items-center"},Ns=["src"],xs=["src"],qs=["data-testid"],Os={key:0,class:"flex items-center py-4 px-6"},Rs={key:0,class:"pr-2 text-left"},Fs={key:1},Us={key:1,class:"text-right"},Vs={key:0},Es={class:"flex justify-center py-4 px-2"},Ws={class:"py-4 px-6 text-right"},ut=U({__name:"PoolsTable",props:{data:{default:()=>[]},poolsType:{default:"unstaked"},isLoading:{type:Boolean},isLoadingMore:{type:Boolean,default:!1},showPoolShares:{type:Boolean,default:!1},noPoolsLabel:{default:"No pools"},isPaginated:{type:Boolean,default:!1},sortColumn:{default:"totalLiquidity"},selectedTokens:{default:()=>[]},hiddenColumns:{default:()=>[]},showBoost:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},columnStates:{default:()=>({})},skeletonClass:{default:"h-64"},shares:{},boosts:{},defaultPoolActions:{},shouldPokePoolsMap:{},hasNonPrefGaugesPoolsAddresses:{}},emits:["loadMore","triggerVote","triggerStake","triggerUnstake","triggerCheckpoint","onColumnSort"],setup(g,{emit:n}){const r=g,c=n,{fNum:k}=Ne(),f=xe(),{t:p}=qe(),{trackGoal:A,Goals:d}=Je(),{darkMode:b}=ze(),{upToLargeBreakpoint:C,upToSmallBreakpoint:u,isMobile:L}=is(),{networkSlug:y}=ee(),{isWalletReady:D}=ce(),M=l(()=>u.value?250:350),j=l(()=>[{name:"Icons",id:"icons",accessor:"uri",Header:"iconColumnHeader",Cell:"iconColumnCell",width:125,noGrow:!0},{name:p("composition"),id:"poolName",accessor:"id",Cell:"poolNameCell",width:r.hiddenColumns.length>=2?M.value:350},{name:p("myBoost"),accessor:e=>`${Z(O(e)).toFixed(3)}x`,align:"right",id:"myBoost",hidden:!r.showBoost,sortKey:e=>Number(O(e)),width:150,cellClassName:"font-numeric"},{name:p("myBalance"),accessor:e=>k(W(e),{style:"currency",maximumFractionDigits:0,fixedFormat:!0}),align:"right",id:"myBalance",hidden:!r.showPoolShares,sortKey:e=>Number(W(e)),width:160,cellClassName:"font-numeric"},{name:p("poolValue"),accessor:e=>k(e.totalLiquidity||0,{style:"currency",maximumFractionDigits:0}),align:"right",id:"totalLiquidity",sortKey:e=>{const o=Number(e.totalLiquidity);return o===1/0||isNaN(o)?0:o},width:150,cellClassName:"font-numeric"},{name:p("volume24h",[p("hourAbbrev")]),accessor:e=>(e==null?void 0:e.volumeSnapshot)||"0",align:"right",id:"volume",Cell:"volumeCell",sortKey:e=>{const o=Number(e==null?void 0:e.volumeSnapshot);return o===1/0||isNaN(o)||o>te?0:o},width:175,cellClassName:"font-numeric"},{name:r.showPoolShares?p("myApr"):p("apr"),Cell:"aprCell",accessor:e=>{var o;return((o=e==null?void 0:e.apr)==null?void 0:o.min.toString())||"0"},align:"right",id:"apr",sortKey:e=>{var B;let o=0;return e!=null&&e.apr&&(o=Number(Oe(e.apr,e.boost))),isFinite(o)&&(((B=e.apr)==null?void 0:B.swapFees)||0)<Re?o:0},width:150},{name:p("expiryDate"),Cell:"lockEndDateCell",accessor:"lockedEndDate",align:"right",id:"lockEndDate",width:150},{name:p("migrate"),Cell:"migrateCell",accessor:"migrate",align:"center",id:"migrate",width:150},{name:p("actions"),Cell:"actionsCell",accessor:"actions",align:"right",id:"actions",hidden:!r.showActions,width:150}]),H=l(()=>j.value.filter(e=>!r.hiddenColumns.includes(e.id)));function V(e,o){A(d.ClickPoolsTableRow);const B=f.resolve({name:"pool",params:{id:e.id,networkSlug:y}});o?window.open(B.href):f.push(B)}function E(e){var o;f.push({name:"migrate-pool",params:{from:e.id,to:(o=me.network.pools.Migrations)==null?void 0:o[e.id].toPoolId},query:{returnRoute:"home"}})}function W(e){var B;const o=((B=r==null?void 0:r.shares)==null?void 0:B[e.id])||"0";return Fe(e,o)}function O(e){var o;return e.boost||((o=r==null?void 0:r.boosts)==null?void 0:o[e.id])||"1"}function se(e){const o=e==null?void 0:e.apr;return o?je(o,O(e),D.value):"0"}function i(e){return e?He(e,as):"—"}function P(e){var o;return(o=K(e.id))!=null&&o.hasIcon?[e.address]:Qe(e)}function pe(e){f.push({name:"add-liquidity",params:{id:e,networkSlug:y}})}function ke(e){f.push({name:"withdraw",params:{id:e,networkSlug:y}})}function fe(e){f.push({name:"pool",params:{id:e,networkSlug:y}})}return(e,o)=>{const B=os,ye=ts,ve=ge,he=ue,_e=ss,be=Ke;return a(),_(be,{shadow:"lg",square:t(C),noBorder:t(C),noPad:"",exposeOverflow:""},{default:v(()=>[G(_e,{columns:H.value,data:e.data,noResultsLabel:e.noPoolsLabel,isLoading:e.isLoading,isLoadingMore:e.isLoadingMore,skeletonClass:e.skeletonClass,sticky:"both",square:t(C),onRowClick:V,isPaginated:e.isPaginated,isOnlyDescSort:"",initialState:{sortColumn:e.sortColumn,sortDirection:"desc"},onOnColumnSort:o[1]||(o[1]=s=>c("onColumnSort",s)),onLoadMore:o[2]||(o[2]=s=>c("loadMore"))},{iconColumnHeader:v(()=>[q("div",Ms,[t(b)?(a(),m("img",{key:0,src:t(rs),alt:"token",loading:"lazy",width:"24",height:"15"},null,8,Ns)):(a(),m("img",{key:1,src:t(us),alt:"token",loading:"lazy",width:"24",height:"15"},null,8,xs))])]),iconColumnCell:v(s=>[e.isLoading?w("",!0):(a(),m("div",{key:0,class:"py-4 px-6","data-testid":s==null?void 0:s.id},[G(B,{addresses:P(s),width:100,size:t(L)?28:32},null,8,["addresses","size"])],8,qs))]),poolNameCell:v(s=>{var N,R;return[e.isLoading?w("",!0):(a(),m("div",Os,[(N=t(K)(s.id))!=null&&N.name?(a(),m("div",Rs,S((R=t(K)(s.id))==null?void 0:R.name),1)):(a(),m("div",Fs,[G(ls,{tokens:t(Ue)(s,s.tokens),isStablePool:t(Ve)(s.poolType),selectedTokens:e.selectedTokens,pickedTokens:e.selectedTokens},null,8,["tokens","isStablePool","selectedTokens","pickedTokens"])])),G(_s,{pool:s},null,8,["pool"])]))]}),volumeCell:v(s=>[(a(),m("div",{key:e.columnStates.volume,class:"flex justify-end py-4 px-6 -mt-1 font-numeric"},[s!=null&&s.volumeSnapshot?(a(),m("span",Us,S(t(k)((s==null?void 0:s.volumeSnapshot)<t(te)?s==null?void 0:s.volumeSnapshot:"-",{style:"currency",maximumFractionDigits:0})),1)):(a(),_(ye,{key:0,class:"w-12 h-4"}))]))]),aprCell:v(s=>[(a(),m("div",{key:e.columnStates.aprs,class:de(["flex justify-end py-4 px-6 -mt-1 font-numeric text-right",{"text-gray-300 dark:text-gray-600 line-through":t(oe)(s.poolType)}])},[!(s!=null&&s.apr)||t(Ee)(s.id)?(a(),m("span",Vs,"-")):(a(),m(X,{key:1},[I(S(se(s))+" ",1),t(oe)(s.poolType)?(a(),_(ve,{key:0,width:"36",text:e.$t("lbpAprTooltip"),iconSize:"sm",iconClass:"ml-1"},null,8,["text"])):s!=null&&s.apr?(a(),_(ns,{key:1,pool:s},null,8,["pool"])):w("",!0)],64))],2))]),migrateCell:v(s=>[q("div",Es,[t(We)(s)?(a(),_(he,{key:0,color:"gradient",size:"sm",onClick:x(N=>E(s),["prevent"])},{default:v(()=>[I(S(e.$t("migrate")),1)]),_:2},1032,["onClick"])):w("",!0)])]),lockEndDateCell:v(s=>[q("div",Ws,S(i(s.lockedEndDate)),1)]),actionsCell:v(s=>{var N,R;return[e.defaultPoolActions?(a(),_(Ds,{key:0,defaultPoolActions:e.defaultPoolActions,pool:s,showPokeAction:!!((N=e.shouldPokePoolsMap)!=null&&N[s.address])||!1,showMigrateGaugeAction:((R=e.hasNonPrefGaugesPoolsAddresses)==null?void 0:R.includes(s.address))||!1,"onClick:add":h=>pe(s.id),"onClick:remove":h=>ke(s.id),"onClick:unstake":h=>c("triggerUnstake",h),"onClick:stake":h=>c("triggerStake",h),"onClick:vote":o[0]||(o[0]=h=>c("triggerVote")),"onClick:migrateGauge":h=>fe(s.id),"onClick:poke":h=>c("triggerCheckpoint",h)},null,8,["defaultPoolActions","pool","showPokeAction","showMigrateGaugeAction","onClick:add","onClick:remove","onClick:unstake","onClick:stake","onClick:migrateGauge","onClick:poke"])):(a(),_(vs,{key:1,pool:s,poolsType:e.poolsType,"onClick:stake":h=>c("triggerStake",h),"onClick:unstake":h=>c("triggerUnstake",h),"onClick:migrate":h=>E(h)},null,8,["pool","poolsType","onClick:stake","onClick:unstake","onClick:migrate"]))]}),_:1},8,["columns","data","noResultsLabel","isLoading","isLoadingMore","skeletonClass","square","isPaginated","initialState"])]),_:1},8,["square","noBorder"])}}});function zs(){const g=new Ye,{account:n}=ce(),r=l(()=>ae[T.value]),c=l(()=>r.value.map(i=>i.slice(0,42))),k=l(()=>!!n.value),f=ne(me.network.subgraphs.gauge,["useUserIsDepositedInAffectedPool","vulnerability","liquidityGauges","unstake",{networkId:T}],()=>({liquidityGauges:{__args:{first:1e3,where:{poolId_in:r.value}},id:!0,symbol:!0,poolId:!0,poolAddress:!0}}),{keepPreviousData:!0,refetchOnWindowFocus:!1}),p=ne("https://data.aura.finance/graphql",["useUserIsDepositedInAffectedPool","vulnerability","auraGauges","unstake",{networkId:T}],()=>({pools:{__args:{chainId:T.value},id:!0,poolId:!0,address:!0,name:!0,lpToken:{address:!0}}}),{keepPreviousData:!0,refetchOnWindowFocus:!1}),A=l(()=>{var i;return((i=f.data.value)==null?void 0:i.liquidityGauges)??[]}),d=l(()=>{const i=A.value.map(P=>({chainId:T.value,address:P.id,decimals:18,symbol:P.symbol,name:P.symbol,tags:["balancer"]}));return z.keyBy(i,"address")}),b=l(()=>{var i;return(((i=p.data.value)==null?void 0:i.pools)??[]).filter(P=>c.value.includes(P.lpToken.address))}),C=l(()=>{const i=b.value.map(P=>({chainId:T.value,address:P.address,decimals:18,symbol:P.name,name:P.name,tags:["aura"]}));return z.keyBy(i,"address")}),u=l(()=>z.merge(C.value,d.value)),L=l(()=>k.value&&(A.value.length>0||b.value.length>0)),y=ie(["useUserIsDepositedInAffectedPool","gauge","balances",{networkId:T,allLiquidityGauges:A,allAuraGauges:b}],async()=>g.balances.get(n.value,u.value),{enabled:L}),D=l(()=>y.data.value||{}),M=l(()=>z.pickBy(u.value,i=>Z(j(J(i.address))).gt(0)));function j(i){return D.value[J(i)]||"0"}const H=l(()=>ae[T.value]),V=l(()=>H.value.map(i=>({id:i,address:i.slice(0,42)}))),E=ie(["useUserIsDepositedInAffectedPool","balances",{networkId:T,account:n}],async()=>{const i=await g.metadata.get(V.value.map(P=>P.address),Xe.value);return g.balances.get(n.value,i)},{enabled:k}),W=l(()=>E.data.value||{}),O=l(()=>V.value.filter(i=>Z(W.value[J(i.address)]||"0").gt(0)));return{isUserDepositedInAffectedPool:l(()=>Object.keys(M.value).length>0||O.value.length>0)}}const js={key:0,class:"px-4 xl:px-0"},dt=U({__name:"UserInvestedInAffectedPoolAlert",setup(g){const n=Y(Ze(le.Alerts.RecoveryExitDismissed,!1)),{networkSlug:r}=ee(),{isUserDepositedInAffectedPool:c}=zs();function k(){es(le.Alerts.RecoveryExitDismissed,!0),n.value=!0}return(f,p)=>{const A=ks;return t(c)&&!t(n)?(a(),m("div",js,[G(A,{type:"error",title:"Pool Vulnerability - August 22, 2023",actionLabel:"Withdraw now",class:"mb-4",block:"",dismissable:"",onClose:k,onActionClick:p[0]||(p[0]=d=>f.$router.push({name:"recovery-exit",params:{networkSlug:t(r)}}))},{default:v(()=>[I("A vulnerability has been discovered that affects a pool you are deposited in. Please withdraw your funds as soon as possible.")]),_:1})])):w("",!0)}}});export{$ as P,dt as _,ut as a};
//# sourceMappingURL=UserInvestedInAffectedPoolAlert.vue_vue_type_script_setup_true_lang-3926eecf.js.map
