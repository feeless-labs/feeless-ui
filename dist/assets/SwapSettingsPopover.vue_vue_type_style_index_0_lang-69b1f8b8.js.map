{"version":3,"file":"SwapSettingsPopover.vue_vue_type_style_index_0_lang-69b1f8b8.js","sources":["../../src/components/forms/AppSlippageForm.vue","../../src/composables/useEthereumTxType.ts","../../src/constants/options.ts","../../src/components/popovers/SwapSettingsPopover.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { computed, reactive, watch } from 'vue';\n\nimport useNumbers from '@/composables/useNumbers';\nimport { useUserSettings } from '@/providers/user-settings.provider';\nimport { bnum } from '@/lib/utils';\n\nconst FIXED_OPTIONS = ['0.005', '0.01', '0.02'];\n\n/**\n * COMPOSABLES\n */\nconst { fNum } = useNumbers();\nconst { slippage, setSlippage } = useUserSettings();\n\n/**\n * STATE\n */\nconst state = reactive({\n  fixedSlippage: '',\n  customSlippage: '',\n  isCustomInput: false,\n});\n\nconst options = FIXED_OPTIONS.map(option => {\n  return {\n    label: fNum(option, {\n      style: 'percent',\n      minimumFractionDigits: 1,\n      maximumFractionDigits: 1,\n      fixedFormat: true,\n    }),\n    value: option,\n  };\n});\n\n/**\n * COMPUTED\n */\nconst isFixedSlippage = computed(() => {\n  return FIXED_OPTIONS.includes(slippage.value);\n});\n\nconst customInputClasses = computed(() => ({\n  'border border-blue-500 text-blue-500':\n    !isFixedSlippage.value && state.isCustomInput,\n  'border dark:border-gray-900': isFixedSlippage.value && !state.isCustomInput,\n}));\n\n/**\n * METHODS\n */\nfunction onFixedInput(val: string): void {\n  state.isCustomInput = false;\n  state.customSlippage = '';\n  setSlippage(val);\n}\n\nfunction onCustomInput(val: string): void {\n  if (!val) return;\n  state.isCustomInput = true;\n  val = bnum(val).div(100).toString();\n  setSlippage(val);\n}\n\n/**\n * WATCHERS\n */\nwatch(\n  slippage,\n  newSlippage => {\n    if (isFixedSlippage.value && !state.isCustomInput) {\n      state.fixedSlippage = newSlippage;\n      state.customSlippage = '';\n    } else {\n      state.customSlippage = bnum(newSlippage).times(100).toString();\n      state.fixedSlippage = '';\n    }\n  },\n  { immediate: true }\n);\n\nwatch(() => state.customSlippage, onCustomInput, { immediate: true });\n</script>\n\n<template>\n  <div class=\"flex\">\n    <BalBtnGroup\n      v-model=\"state.fixedSlippage\"\n      :options=\"options\"\n      @update:model-value=\"onFixedInput\"\n    />\n    <div :class=\"['custom-input', customInputClasses]\">\n      <input\n        v-model=\"state.customSlippage\"\n        class=\"w-12 text-right bg-transparent\"\n        placeholder=\"0.1\"\n        type=\"number\"\n        step=\"any\"\n        min=\"0\"\n      />\n      <div class=\"px-2\">%</div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.custom-input {\n  @apply flex items-center px-1 rounded-lg shadow-inner;\n}\n</style>\n","import { ref } from 'vue';\n\nimport LS_KEYS from '@/constants/local-storage.keys';\nimport { lsGet, lsSet } from '@/lib/utils';\n\nexport enum EthereumTxType {\n  LEGACY = 'Legacy',\n  EIP1559 = 'EIP1559',\n}\n\nconst lsEthereumTxType = lsGet(\n  LS_KEYS.App.EthereumTxType,\n  EthereumTxType.EIP1559\n);\n\n// STATE\nexport const ethereumTxType = ref<EthereumTxType>(lsEthereumTxType);\n\n// MUTATIONS\nfunction setEthereumTxType(txType: EthereumTxType): void {\n  ethereumTxType.value = txType;\n  lsSet(LS_KEYS.App.EthereumTxType, txType);\n}\n\n// INIT\nsetEthereumTxType(ethereumTxType.value);\n\nexport default function useEthereumTxType() {\n  return {\n    ethereumTxType,\n    setEthereumTxType,\n  };\n}\n","import { EthereumTxType } from '@/composables/useEthereumTxType';\n\nexport const ethereumTxTypeOptions = Object.values(EthereumTxType)\n  .filter(v => typeof v === 'string')\n  .map(option => ({\n    label: option,\n    value: option,\n  }));\n","<script lang=\"ts\">\nexport enum SwapSettingsContext {\n  swap,\n  invest,\n}\n</script>\n\n<script setup lang=\"ts\">\nimport AppSlippageForm from '@/components/forms/AppSlippageForm.vue';\nimport { useApp } from '@/composables/useApp';\nimport useEthereumTxType from '@/composables/useEthereumTxType';\nimport useFathom from '@/composables/useFathom';\nimport { ethereumTxTypeOptions } from '@/constants/options';\nimport { useUserSettings } from '@/providers/user-settings.provider';\nimport { isEIP1559SupportedNetwork } from '@/composables/useNetwork';\n\ntype Props = {\n  context: SwapSettingsContext;\n  isGassless?: boolean;\n};\n\nconst props = withDefaults(defineProps<Props>(), {\n  isGassless: false,\n});\n\n// DATA\nconst { context } = toRefs(props);\n\n// COMPOSABLES\nconst { transactionDeadline, setTransactionDeadline } = useApp();\n\nconst { trackGoal, Goals } = useFathom();\nconst { ethereumTxType, setEthereumTxType } = useEthereumTxType();\nconst { supportSignatures, setSupportSignatures } = useUserSettings();\n\n// METHODS\nfunction onActivatorClick(): void {\n  if (context.value === SwapSettingsContext.swap) {\n    trackGoal(Goals.ClickSwapSettings);\n  } else if (context.value === SwapSettingsContext.invest) {\n    trackGoal(Goals.ClickJoinPoolSettings);\n  }\n}\n</script>\n\n<template>\n  <BalPopover>\n    <template #activator>\n      <BalBtn\n        circle\n        color=\"white\"\n        size=\"sm\"\n        class=\"mb-2 text-secondary icon-spin-anim\"\n        @click=\"onActivatorClick\"\n      >\n        <BalIcon name=\"settings\" size=\"sm\" />\n      </BalBtn>\n    </template>\n\n    <div>\n      <div class=\"flex items-baseline\">\n        <span class=\"mb-2 font-medium\" v-text=\"$t('slippageTolerance')\" />\n        <BalTooltip>\n          <template #activator>\n            <BalIcon name=\"info\" size=\"xs\" class=\"-mb-px ml-1 text-gray-400\" />\n          </template>\n          <div v-html=\"$t('marketConditionsWarning')\" />\n        </BalTooltip>\n      </div>\n      <AppSlippageForm class=\"mt-1\" />\n    </div>\n    <div v-if=\"isEIP1559SupportedNetwork\" class=\"mt-6\">\n      <div class=\"flex items-baseline\">\n        <span class=\"mb-2 font-medium\" v-text=\"$t('transactionType')\" />\n        <BalTooltip>\n          <template #activator>\n            <BalIcon name=\"info\" size=\"xs\" class=\"-mb-px ml-1 text-gray-400\" />\n          </template>\n          <div v-text=\"$t('ethereumTxTypeTooltip')\" />\n        </BalTooltip>\n      </div>\n      <div class=\"flex mt-1\">\n        <BalBtnGroup\n          v-model=\"ethereumTxType\"\n          :options=\"ethereumTxTypeOptions\"\n          @update:model-value=\"setEthereumTxType\"\n        />\n      </div>\n    </div>\n    <div class=\"mt-6\">\n      <div class=\"flex items-baseline\">\n        <span class=\"mb-2 font-medium\" v-text=\"$t('useSignatures')\" />\n        <BalTooltip>\n          <template #activator>\n            <BalIcon name=\"info\" size=\"xs\" class=\"-mb-px ml-1 text-gray-400\" />\n          </template>\n          <div v-text=\"$t('useSignaturesTooltip')\" />\n        </BalTooltip>\n      </div>\n      <BalToggle\n        v-model=\"supportSignatures\"\n        name=\"supportSignatures\"\n        @toggle=\"setSupportSignatures\"\n      />\n    </div>\n    <div v-if=\"isGassless && context === SwapSettingsContext.swap\" class=\"mt-6\">\n      <div class=\"flex items-baseline\">\n        <span class=\"mb-2 font-medium\" v-text=\"$t('transactionDeadline')\" />\n        <BalTooltip>\n          <template #activator>\n            <BalIcon name=\"info\" size=\"xs\" class=\"-mb-px ml-1 text-gray-400\" />\n          </template>\n          <div v-html=\"$t('transactionDeadlineTooltip')\" />\n        </BalTooltip>\n      </div>\n      <div class=\"flex mt-1\">\n        <div\n          class=\"flex items-center px-1 rounded-lg border dark:border-gray-700 shadow-inner\"\n        >\n          <input\n            v-model=\"transactionDeadline\"\n            class=\"w-8 text-right bg-transparent\"\n            placeholder=\"20\"\n            type=\"number\"\n            step=\"1\"\n            min=\"0\"\n            @update:modelValue=\"setTransactionDeadline\"\n          />\n        </div>\n        <div class=\"px-2\">minutes</div>\n      </div>\n    </div>\n  </BalPopover>\n</template>\n\n\n<style>\n.swap-settings-option:hover {\n  @apply text-blue-500 border-blue-500;\n}\n\n.swap-settings-option.active {\n  @apply text-blue-500 border-blue-500;\n}\n</style>\n"],"names":["FIXED_OPTIONS","fNum","useNumbers","slippage","setSlippage","useUserSettings","state","reactive","options","option","isFixedSlippage","computed","customInputClasses","onFixedInput","val","onCustomInput","bnum","watch","newSlippage","EthereumTxType","lsEthereumTxType","lsGet","LS_KEYS","ethereumTxType","ref","setEthereumTxType","txType","lsSet","useEthereumTxType","ethereumTxTypeOptions","v","SwapSettingsContext","SwapSettingsContext2","props","__props","context","toRefs","transactionDeadline","setTransactionDeadline","useApp","trackGoal","Goals","useFathom","supportSignatures","setSupportSignatures","onActivatorClick"],"mappings":"gmBAOA,MAAAA,EAAA,CAAA,QAAA,OAAA,MAAA,EAKA,CAAA,KAAAC,GAAAC,IACA,CAAA,SAAAC,EAAA,YAAAC,CAAA,EAAAC,EAAA,EAKAC,EAAAC,EAAA,CAAuB,cAAA,GACN,eAAA,GACC,cAAA,EACD,CAAA,EAGjBC,EAAAR,EAAA,IAAAS,IACE,CAAO,MAAAR,EAAAQ,EAAA,CACe,MAAA,UACX,sBAAA,EACgB,sBAAA,EACA,YAAA,EACV,CAAA,EACd,MAAAA,CACM,EACT,EAMFC,EAAAC,EAAA,IACEX,EAAA,SAAAG,EAAA,KAAA,CAA4C,EAG9CS,EAAAD,EAAA,KAAA,CAA2C,uCAAA,CAAAD,EAAA,OAAAJ,EAAA,cAEP,8BAAAI,EAAA,OAAA,CAAAJ,EAAA,aAC6B,EAAA,EAMjE,SAAAO,EAAAC,EAAA,CACER,EAAA,cAAA,GACAA,EAAA,eAAA,GACAF,EAAAU,CAAA,CAAe,CAGjB,SAAAC,EAAAD,EAAA,CACEA,IACAR,EAAA,cAAA,GACAQ,EAAAE,EAAAF,CAAA,EAAA,IAAA,GAAA,EAAA,WACAV,EAAAU,CAAA,EAAe,CAMjB,OAAAG,EAAAd,EACEe,GAAA,CAEER,EAAA,OAAA,CAAAJ,EAAA,eACEA,EAAA,cAAAY,EACAZ,EAAA,eAAA,KAEAA,EAAA,eAAAU,EAAAE,CAAA,EAAA,MAAA,GAAA,EAAA,WACAZ,EAAA,cAAA,GACF,EACF,CAAA,UAAA,EAAA,CACkB,EAGpBW,EAAA,IAAAX,EAAA,eAAAS,EAAA,CAAA,UAAA,EAAA,CAAA,oeC7EY,IAAAI,GAAAA,IACVA,EAAA,OAAS,SACTA,EAAA,QAAU,UAFAA,IAAAA,GAAA,CAAA,CAAA,EAKZ,MAAMC,GAAmBC,EACvBC,EAAQ,IAAI,eACZ,SACF,EAGaC,EAAiBC,EAAoBJ,EAAgB,EAGlE,SAASK,EAAkBC,EAA8B,CACvDH,EAAe,MAAQG,EACjBC,EAAAL,EAAQ,IAAI,eAAgBI,CAAM,CAC1C,CAGAD,EAAkBF,EAAe,KAAK,EAEtC,SAAwBK,IAAoB,CACnC,MAAA,CACL,eAAAL,EACA,kBAAAE,CAAA,CAEJ,CC9BO,MAAMI,GAAwB,OAAO,OAAOV,CAAc,EAC9D,OAAYW,GAAA,OAAOA,GAAM,QAAQ,EACjC,IAAerB,IAAA,CACd,MAAOA,EACP,MAAOA,CACT,EAAE,0gBCNG,IAAAsB,IAAAC,IACLA,EAAAA,EAAA,KAAA,CAAA,EAAA,OACAA,EAAAA,EAAA,OAAA,CAAA,EAAA,SAFUA,IAAAD,IAAA,CAAA,CAAA,4GAoBZ,MAAAE,EAAAC,EAKA,CAAA,QAAAC,CAAA,EAAAC,GAAAH,CAAA,EAGA,CAAA,oBAAAI,EAAA,uBAAAC,CAAA,EAAAC,GAAA,EAEA,CAAA,UAAAC,EAAA,MAAAC,CAAA,EAAAC,GAAA,EACA,CAAA,eAAAnB,EAAA,kBAAAE,CAAA,EAAAG,GAAA,EACA,CAAA,kBAAAe,EAAA,qBAAAC,CAAA,EAAAvC,EAAA,EAGA,SAAAwC,GAAA,CACEV,EAAA,QAAA,EACEK,EAAAC,EAAA,iBAAA,EAAiCN,EAAA,QAAA,GAEjCK,EAAAC,EAAA,qBAAA,CACF"}