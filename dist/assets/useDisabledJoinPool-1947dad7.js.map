{"version":3,"file":"useDisabledJoinPool-1947dad7.js","sources":["../../src/components/_global/icons/StarsIcon.vue","../../src/composables/useDisabledJoinPool.ts"],"sourcesContent":["<script lang=\"ts\" setup>\nimport useTailwind from '@/composables/useTailwind';\n\n/**\n * TYPES\n */\ntype Props = {\n  gradFrom?: string;\n  gradTo?: string;\n};\n\n/**\n * PROPS & EMITS\n */\nconst props = withDefaults(defineProps<Props>(), {\n  gradFrom: 'yellow',\n  gradTo: 'pink',\n});\n\n/**\n * COMPOSABLES\n */\nconst { theme } = useTailwind();\n\n/**\n * COMPUTED\n */\nconst gradientId = computed(\n  (): string => `stars-gradient-${props.gradFrom}-${props.gradTo}`\n);\n</script>\n\n<template>\n  <svg\n    width=\"24\"\n    height=\"25\"\n    viewBox=\"0 0 24 25\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <defs>\n      <linearGradient\n        :id=\"gradientId\"\n        x1=\"24\"\n        y1=\"-11.5\"\n        x2=\"2.7273\"\n        y2=\"16.3182\"\n        gradientUnits=\"userSpaceOnUse\"\n      >\n        <stop :stop-color=\"theme.colors[gradTo]['500']\" />\n        <stop offset=\"1\" :stop-color=\"theme.colors[gradFrom]['500']\" />\n      </linearGradient>\n    </defs>\n    <path\n      fill-rule=\"evenodd\"\n      clip-rule=\"evenodd\"\n      d=\"M21.7809 7.27232C20.6203 7.70216 19.7081 8.67468 19.305 9.91198L18.5527 12.2203C18.5419 12.2555 18.5111 12.2792 18.4764 12.2792C18.4417 12.2792 18.4109 12.2555 18.4001 12.2203L17.6479 9.91198C17.2447 8.67461 16.3323 7.70207 15.1716 7.27232L13.0065 6.47049C12.9742 6.45851 12.9525 6.42606 12.9525 6.38961C12.9525 6.35316 12.9742 6.32071 13.0065 6.30873L15.1716 5.5069C16.3323 5.07715 17.2447 4.10461 17.6479 2.86724L18.4001 0.558892C18.4109 0.523752 18.4417 0.5 18.4764 0.5C18.5111 0.5 18.5419 0.523752 18.5527 0.558892L19.305 2.86724C19.7081 4.10455 20.6203 5.07707 21.7809 5.5069L23.9461 6.30873C23.9783 6.32071 24 6.35316 24 6.38961C24 6.42606 23.9783 6.45851 23.9461 6.47049L21.7809 7.27232ZM12.2613 14.4746C10.6494 15.0717 9.38251 16.4224 8.82264 18.1409L7.77749 21.3469C7.76214 21.3952 7.71964 21.4276 7.67183 21.4276C7.62402 21.4276 7.58152 21.3952 7.56617 21.3469L6.52102 18.1409C5.96115 16.4224 4.69427 15.0717 3.08238 14.4746L0.0748959 13.361C0.0300526 13.3443 0 13.2993 0 13.2486C0 13.198 0.0300526 13.153 0.0748959 13.1363L3.08238 12.0227C4.69428 11.4256 5.96116 10.0749 6.52102 8.35643L7.56617 5.1504C7.58152 5.10213 7.62402 5.06965 7.67183 5.06965C7.71964 5.06965 7.76214 5.10213 7.77749 5.1504L8.82264 8.35643C9.38251 10.0749 10.6494 11.4256 12.2613 12.0227L15.2688 13.1363C15.3136 13.153 15.3437 13.198 15.3437 13.2486C15.3437 13.2993 15.3136 13.3443 15.2688 13.361L12.2613 14.4746ZM18.4025 22.6042C18.725 21.6144 19.4546 20.8364 20.383 20.4924L22.1159 19.851C22.1417 19.8414 22.1591 19.8154 22.1591 19.7862C22.1591 19.7571 22.1417 19.7311 22.1159 19.7215L20.383 19.0801C19.4546 18.7361 18.725 17.9581 18.4025 16.9683L17.8005 15.1217C17.7925 15.0925 17.7674 15.0725 17.7389 15.0725C17.7104 15.0725 17.6853 15.0925 17.6773 15.1217L17.0768 16.9683C16.754 17.9585 16.0237 18.7365 15.0948 19.0801L13.3634 19.7215C13.3376 19.7311 13.3202 19.7571 13.3202 19.7862C13.3202 19.8154 13.3376 19.8414 13.3634 19.851L15.0948 20.4924C16.0237 20.836 16.754 21.614 17.0768 22.6042L17.6773 24.4509C17.6853 24.48 17.7104 24.5 17.7389 24.5C17.7674 24.5 17.7925 24.48 17.8005 24.4509L18.4025 22.6042Z\"\n      :fill=\"`url(#${gradientId})`\"\n    />\n  </svg>\n</template>\n","import {\n  createdAfterTimestamp,\n  filterTokensInList,\n  isFx,\n  isJoinsDisabled,\n  isManaged,\n  isStableLike,\n  isWeighted,\n  noInitLiquidity,\n} from '@/composables/usePoolHelpers';\nimport { computed } from 'vue';\n\nimport { isSameAddress } from '@/lib/utils';\nimport { useTokenLists } from '@/providers/token-lists.provider';\nimport { configService } from '@/services/config/config.service';\nimport { Pool } from '@/services/pool/types';\nimport useWeb3 from '@/services/web3/useWeb3';\nimport { isAddress } from '@ethersproject/address';\nimport { isTestnet } from './useNetwork';\n\nconst POOLS = configService.network.pools;\n\nfunction doesRequireAllowListing(pool: Pool, account: string): boolean {\n  const requiresAllowlisting =\n    (isStableLike(pool.poolType) && !isFx(pool.poolType)) ||\n    isManaged(pool.poolType);\n  const isOwnedByUser =\n    pool.owner && isAddress(account) && isSameAddress(pool.owner, account);\n  const isAllowlisted =\n    POOLS.Stable.AllowList.includes(pool.id) ||\n    POOLS.Investment.AllowList.includes(pool.id);\n  return (\n    !isTestnet.value && requiresAllowlisting && !isAllowlisted && !isOwnedByUser\n  );\n}\n\nexport function useDisabledJoinPool(pool: Pool) {\n  const { account } = useWeb3();\n  const { balancerTokenList } = useTokenLists();\n\n  const notVettedTokens = computed(() => {\n    const vettedTokenAddresses = balancerTokenList.value.tokens.map(\n      t => t.address\n    );\n\n    // Returns tokens whose addresses are not included inside vetted token list\n    return filterTokensInList(pool, vettedTokenAddresses);\n  });\n\n  const nonVettedTokensAfterTimestamp = computed(() => {\n    return (\n      !isTestnet.value &&\n      createdAfterTimestamp(pool) &&\n      notVettedTokens.value.length > 0\n    );\n  });\n\n  const nonAllowedWeightedPoolAfterTimestamp = computed(() => {\n    return (\n      !isTestnet.value &&\n      isWeighted(pool.poolType) &&\n      createdAfterTimestamp(pool) &&\n      !POOLS.Weighted.AllowList.includes(pool.id)\n    );\n  });\n\n  const nonAllowedSymbols = computed(() => {\n    return notVettedTokens.value.map(token => token.symbol).join(',');\n  });\n\n  const notInitialLiquidity = computed(() => {\n    return noInitLiquidity(pool);\n  });\n\n  const requiresAllowListing = computed(() => {\n    return doesRequireAllowListing(pool, account.value);\n  });\n\n  const disableJoinsReason = computed(() => ({\n    notInitialLiquidity: notInitialLiquidity.value,\n    requiresAllowListing: requiresAllowListing.value,\n    nonVettedTokensAfterTimestamp: nonVettedTokensAfterTimestamp.value,\n    nonAllowedWeightedPoolAfterTimestamp:\n      nonAllowedWeightedPoolAfterTimestamp.value,\n    hardcoded: isJoinsDisabled(pool.id),\n  }));\n\n  const shouldDisableJoins = computed(() => {\n    // Returns true if at least one of the disable reasons is true\n    return Object.values(disableJoinsReason.value).some(\n      reason => reason === true\n    );\n  });\n\n  return {\n    nonAllowedSymbols,\n    disableJoinsReason,\n    shouldDisableJoins,\n  };\n}\n"],"names":["props","__props","theme","useTailwind","gradientId","computed","POOLS","configService","doesRequireAllowListing","pool","account","requiresAllowlisting","isStableLike","isFx","isManaged","isOwnedByUser","isAddress","isSameAddress","isAllowlisted","isTestnet","useDisabledJoinPool","useWeb3","balancerTokenList","useTokenLists","notVettedTokens","vettedTokenAddresses","t","filterTokensInList","nonVettedTokensAfterTimestamp","createdAfterTimestamp","nonAllowedWeightedPoolAfterTimestamp","isWeighted","nonAllowedSymbols","token","notInitialLiquidity","noInitLiquidity","requiresAllowListing","disableJoinsReason","isJoinsDisabled","shouldDisableJoins","reason"],"mappings":"sbAcA,MAAAA,EAAAC,EAQA,CAAA,MAAAC,GAAAC,IAKAC,EAAAC,EAAmB,IAAA,kBAAAL,EAAA,QAAA,IAAAA,EAAA,MAAA,EAC6C,s7ECR1DM,EAAQC,EAAc,QAAQ,MAEpC,SAASC,EAAwBC,EAAYC,EAA0B,CACrE,MAAMC,EACHC,EAAaH,EAAK,QAAQ,GAAK,CAACI,EAAKJ,EAAK,QAAQ,GACnDK,EAAUL,EAAK,QAAQ,EACnBM,EACJN,EAAK,OAASO,EAAUN,CAAO,GAAKO,EAAcR,EAAK,MAAOC,CAAO,EACjEQ,EACJZ,EAAM,OAAO,UAAU,SAASG,EAAK,EAAE,GACvCH,EAAM,WAAW,UAAU,SAASG,EAAK,EAAE,EAC7C,MACE,CAACU,EAAU,OAASR,GAAwB,CAACO,GAAiB,CAACH,CAEnE,CAEO,SAASK,EAAoBX,EAAY,CACxC,KAAA,CAAE,QAAAC,GAAYW,IACd,CAAE,kBAAAC,GAAsBC,IAExBC,EAAkBnB,EAAS,IAAM,CAC/B,MAAAoB,EAAuBH,EAAkB,MAAM,OAAO,OACrDI,EAAE,OAAA,EAIF,OAAAC,EAAmBlB,EAAMgB,CAAoB,CAAA,CACrD,EAEKG,EAAgCvB,EAAS,IAE3C,CAACc,EAAU,OACXU,EAAsBpB,CAAI,GAC1Be,EAAgB,MAAM,OAAS,CAElC,EAEKM,EAAuCzB,EAAS,IAElD,CAACc,EAAU,OACXY,EAAWtB,EAAK,QAAQ,GACxBoB,EAAsBpB,CAAI,GAC1B,CAACH,EAAM,SAAS,UAAU,SAASG,EAAK,EAAE,CAE7C,EAEKuB,EAAoB3B,EAAS,IAC1BmB,EAAgB,MAAM,IAAIS,GAASA,EAAM,MAAM,EAAE,KAAK,GAAG,CACjE,EAEKC,EAAsB7B,EAAS,IAC5B8B,EAAgB1B,CAAI,CAC5B,EAEK2B,EAAuB/B,EAAS,IAC7BG,EAAwBC,EAAMC,EAAQ,KAAK,CACnD,EAEK2B,EAAqBhC,EAAS,KAAO,CACzC,oBAAqB6B,EAAoB,MACzC,qBAAsBE,EAAqB,MAC3C,8BAA+BR,EAA8B,MAC7D,qCACEE,EAAqC,MACvC,UAAWQ,EAAgB7B,EAAK,EAAE,CAClC,EAAA,EAEI8B,EAAqBlC,EAAS,IAE3B,OAAO,OAAOgC,EAAmB,KAAK,EAAE,QACnCG,IAAW,EAAA,CAExB,EAEM,MAAA,CACL,kBAAAR,EACA,mBAAAK,EACA,mBAAAE,CAAA,CAEJ"}